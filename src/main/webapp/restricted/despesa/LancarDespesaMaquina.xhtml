<ui:composition template="/WEB-INF/template/LayoutPadrao.xhtml"
    xmlns="http://www.w3.org/1999/xhtml"
 	xmlns:h="http://xmlns.jcp.org/jsf/html"
 	xmlns:f="http://xmlns.jcp.org/jsf/core"
 	xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
    xmlns:p="http://primefaces.org/ui"
    xmlns:o="http://omnifaces.org/ui">

    <ui:define name="titulo">Despesas com Máquinas e Implementos</ui:define>
    
    <ui:define name="corpo">
   	
   		<h2>Despesas com Máquinas</h2>
   		
    	<h:form id="form">
    	
    		<p:growl id="msgs" showDetail="true" /> 
      		
	    	<div class="field col-12 md:col-4">
                <p:outputLabel for="month" value="Mês/Ano"/>
                <p:datePicker id="month" view="month" 
                	value="#{lancarDespesaMaquinaBean.mesAno}" 
                	pattern="MM/yyyy" yearNavigator="true" yearRange="2000:2030"/>
            </div>	
	    	
	    	
	    	<p:panelGrid id="gridDespesa" columns="4" style="width: 100%; margin-top: 20px"
	    		columnClasses="rotulo, campo">

				<p:outputLabel value="Máquina" for="maquina"/>
	    		<p:selectOneMenu id="maquina" 
	    			value="#{lancarDespesaMaquinaBean.despesaMaquina.maquina}" 
	    			required="true" 
			    	validatorMessage="A máquina é obrigatória.">
	    			<f:selectItem itemLabel="Selecione a máquina" />
	    			<f:selectItems value="#{lancarDespesaMaquinaBean.maquinas}" var="maquina" 
						itemLabel="#{maquina.nome}" itemValue="#{maquina}"/>
						
					<p:ajax listener="#{lancarDespesaMaquinaBean.buscarPrecoCombustivel}"
						update="tipo comb preco" process="maquina"/>
	    		</p:selectOneMenu>
	    		
	    		<p:outputLabel value="Tipo"/>
	    		<p:outputLabel id="tipo" value="#{lancarDespesaMaquinaBean.despesaMaquina.maquina.tipo}"/>
		
		        <p:outputLabel value="Combustível"/>
	    		<p:outputLabel id="comb" value="#{lancarDespesaMaquinaBean.despesaMaquina.maquina.tipoCombustivel}"/>	 
		
				<p:outputLabel value="Preço (l/kwh)"/>
				<h:panelGroup>
		    		<p:inputNumber id="preco" 
			    		symbol="R$ " symbolPosition="p" 
	                    decimalSeparator="," thousandSeparator="."
	                    minValue="0" decimalPlaces="2" 
		    			value="#{lancarDespesaMaquinaBean.precoCombustivel.valor}"
		    			readonly="true">
		    		</p:inputNumber>
		    		
		    		<p:spacer width="10px" />			
		    		
					<p:commandButton value="Cadastrar Preço" title="Cadastrar Preço"> 	    			
					</p:commandButton>
				</h:panelGroup>
	    		
	    		<p:outputLabel value="Intensidade" for="intensidade"/>
	    		<p:selectOneMenu id="intensidade" 
	    			value="#{lancarDespesaMaquinaBean.despesaMaquina.intensidade}" 
	    			required="true" 
			    	validatorMessage="A intensidade é obrigatória.">
	    			<f:selectItem itemLabel="Selecione a intensidade de trabalho da máquina" />
	    			<f:selectItems value="#{lancarDespesaMaquinaBean.intensidades}" var="intensidade" 
						itemLabel="#{intensidade}" itemValue="#{intensidade}"/>
	    		</p:selectOneMenu>
	    		
	    		<p:outputLabel value="Horas Trabalhadas" for="ht"/>
	    		<p:inputNumber id="ht" value="#{lancarDespesaMaquinaBean.despesaMaquina.horasTrabalhadas}" 
	                decimalSeparator="," thousandSeparator="."
                    minValue="0" decimalPlaces="2" 
	    			required="true" 
			    	validatorMessage="A quantidade de horas trabalhadas é obrigatória.">			    	
			    </p:inputNumber>
		        
	        </p:panelGrid>
	        
	        <p:commandButton value="Salvar" id="botaoSalvar" icon="pi pi-save"
	    				action="#{lancarDespesaMaquinaBean.salvar}" update="despesasTable"
	    				style="margin-top: 10px; margin-bottom: 10px"/>
	    				
	    	<p:commandButton value="Limpar" id="botaoLimpar" icon="pi pi-save"
	    				action="#{lancarDespesaMaquinaBean.limpar}" update="gridDespesa"
	    				style="margin-top: 10px; margin-bottom: 10px"/> 	
	    			 
	        
	        <p:dataTable id="despesasTable" value="#{lancarDespesaMaquinaBean.despesas}" 
	        		var="despesa"
		    		style="margin-top: 20px" emptyMessage="Nenhuma despesa encontrada." rows="10"
		    		paginator="true" paginatorAlwaysVisible="true" paginatorPosition="bottom"
		    		rowsPerPageTemplate="5,10,15">
		    		
	    		<p:column headerText="Mês/Ano" style="width: 10px; text-align: center">
	    			<h:outputText value="#{despesa.mesAno}">
	    				<f:convertDateTime type="localDate" pattern="MM/yyyy" />
    				</h:outputText>
	    		</p:column>	    		
	    		
	    		<p:column headerText="Maquina" sortBy="#{despesa.maquina.nome}" 
	    			style="width: 30px; text-align: left">
	    			<h:outputText value="#{despesa.maquina.nome}" />
	    		</p:column>
	    		
	    		<p:column headerText="Combustível" style="width: 30px; text-align: left">
	    			<h:outputText value="#{despesa.maquina.tipoCombustivel}" />
	    		</p:column>
	    		
	    		<p:column headerText="Preço Unitário" style="width: 30px; text-align: center">
	    			<h:outputText value="22,22" />
	    		</p:column>
	    		
	    		<p:column headerText="Intensidade" style="width: 30px; text-align: left">
	    			<h:outputText value="#{despesa.intensidade}"/>
	    		</p:column>
	    		
	    		<p:column headerText="Valor Total" style="width: 30px; text-align: center">
	    			<h:outputText value="999,99" />
	    		</p:column>
	    		
	    		<p:column headerText="Operações" style="width: 30px; text-align: center">

	    		</p:column>
    		</p:dataTable>	        
	        	
    			
	    </h:form>
    
    </ui:define>
</ui:composition>