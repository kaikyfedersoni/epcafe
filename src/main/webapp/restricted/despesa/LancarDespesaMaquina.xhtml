<ui:composition template="/WEB-INF/template/LayoutPadrao.xhtml"
    xmlns="http://www.w3.org/1999/xhtml"
 	xmlns:h="http://xmlns.jcp.org/jsf/html"
 	xmlns:f="http://xmlns.jcp.org/jsf/core"
 	xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
    xmlns:p="http://primefaces.org/ui"
    xmlns:o="http://omnifaces.org/ui">

    <ui:define name="titulo">Despesas com Máquinas e Implementos</ui:define>
    
    <ui:define name="corpo">
   	
   		<h2>Despesas com Máquinas</h2>
   		
    	<h:form id="form">
    	
    		<p:growl id="msgs" showDetail="true" /> 
    		
    		<!--  trocar por selectOneMenu -->
    		
    		<p:outputLabel value="Ano" for="ano"/>
	    	<p:inputText id="ano" size="10" maxlength="4" 
	    			value="#{lancarDespesaMaquinaBean.ano}"
	    			required="true" 
			    	validatorMessage="O ano é obrigatório."/>	 	
	    		    		
    		<!-- COMBUSTIVEL VALORES -->
    		
    		
    		<p:dataTable id="combustiveisTable" widgetVar="dtConbustiveis" style="margin-top: 10px" 
	    		var="preco" value="#{lancarDespesaMaquinaBean.precosCombustiveis}" 
	    		selectionMode="single" 
	    		selection="#{lancarDespesaMaquinaBean.precoSelecionado}" rowKey="#{preco.id}"
	    		editable="true">	
	    		
	    		<f:facet name="header">
	                <div class="grid mt-3">
			            <div class="col-12">
			                <p:commandButton value="Adicionar Preço" 
			                	process="@this" 
			                	update=":form:msgs :form:combustiveisTable"
			                    action="#{lancarDespesaMaquinaBean.onAddNewCombustivel()}"/>
			           
				            <p:commandButton value="Excluir Preço" 
				            	actionListener="#{lancarDespesaMaquinaBean.onDeleteCombustivel}"
				            	update=":form:msgs :form:combustiveisTable">
			                </p:commandButton>
                		</div>
			        </div>
	            </f:facet>            

	            <p:ajax event="rowEdit" listener="#{lancarDespesaMaquinaBean.onRowEditCombustivel}" update=":form:msgs"/>
	            <p:ajax event="rowEditCancel" listener="#{lancarDespesaMaquinaBean.onRowCancelCombustivel}" update=":form:msgs"/>
				<p:ajax event="rowSelectCheckbox" update="combustiveisTable"/>
	            <p:ajax event="rowUnselectCheckbox" update="combustiveisTable"/>
		
	            <p:column headerText="Combustível" style="width: 80px; text-align: left">
	            	<h:outputText value="combustivel #{preco.id}"/>
	            </p:column>
	
	            <p:column headerText="Janeiro" style="width: 20px; text-align: center">
	                <p:cellEditor>
	                    <f:facet name="output">
	                    	<h:outputText value="#{preco.valor1}"/>
	                    </f:facet>
	                    <f:facet name="input">
	                    	<p:inputText value="#{preco.valor1}" style="width:100%" 
	                    		label="Valor"/>
	                    	</f:facet>
	                </p:cellEditor>
	            </p:column>
	            <p:column headerText="Fevereiro" style="width: 20px; text-align: center">
	                <p:cellEditor>
	                    <f:facet name="output">
	                    	<h:outputText value="#{preco.valor2}"/>
	                    </f:facet>
	                    <f:facet name="input">
	                    	<p:inputText value="#{preco.valor2}" style="width:100%" 
	                    		label="Valor"/>
	                    	</f:facet>
	                </p:cellEditor>
	            </p:column>
	
	            <p:column headerText="Operações" style="width:8rem">
	                <p:rowEditor/>
	            </p:column>
	            
	             <p:column headerText="Total" style="width: 20px; text-align: center">
	                <h:outputLabel value="totais" />
	            </p:column>
	            
	            <f:facet name="footer">
	                <div class="grid mt-3">
			            <div class="col-12">
			                <h:outputLabel value="totais"/>
                		</div>
			        </div>
	            </f:facet>  
	        </p:dataTable>
			
			
			<!-- DESPESAS -->
			
	    	
	    	<p:dataTable id="despesasTable" widgetVar="dtDespesa" style="margin-top: 10px" 
	    		var="despesa" value="#{lancarDespesaMaquinaBean.despesas}"
	    		selectionMode="single" 
	    		selection="#{lancarDespesaMaquinaBean.despesaSelecionada}" rowKey="#{despesa.id}"
	    		editable="true">   	

	            <f:facet name="header">
	                <div class="grid mt-3">
			            <div class="col-12">
			                <p:commandButton value="Adicionar Despesa" 
			                	process="@this" 
			                	update=":form:msgs :form:despesasTable"
			                    action="#{lancarDespesaMaquinaBean.onAddNew()}"/>
			           
				            <p:commandButton value="Excluir Despesa" 
				            	actionListener="#{lancarDespesaMaquinaBean.onDelete}"
				            	update=":form:msgs :form:despesasTable">
			                </p:commandButton>
                		</div>
			        </div>
	            </f:facet>
	
	            <p:ajax event="rowEdit" listener="#{lancarDespesaMaquinaBean.onRowEdit}" update=":form:msgs"/>
	            <p:ajax event="rowEditCancel" listener="#{lancarDespesaMaquinaBean.onRowCancel}" update=":form:msgs"/>
				<p:ajax event="rowSelectCheckbox" update="despesasTable"/>
	            <p:ajax event="rowUnselectCheckbox" update="despesasTable"/>
		
		
	            <p:column headerText="Máquina" style="width: 80px; text-align: left">
	            	<h:outputText value="maquina #{despesa.id}"/>
	            </p:column>	
	            
	            <p:column headerText="Janeiro" style="width: 20px; text-align: center">
	                <p:cellEditor>
	                    <f:facet name="output">
	                    	<h:outputText value="#{despesa.horas1}"/>
	                    </f:facet>
	                    <f:facet name="input">
	                    	<p:inputText value="#{despesa.horas1}" style="width:100%" 
	                    		label="Horas"/>
	                    	</f:facet>
	                </p:cellEditor>
	            </p:column>
	            <p:column headerText="Fevereiro" style="width: 20px; text-align: center">
	                <p:cellEditor>
	                    <f:facet name="output">
	                    	<h:outputText value="#{despesa.horas2}"/>
	                    </f:facet>
	                    <f:facet name="input">
	                    	<p:inputText value="#{despesa.horas2}" style="width:100%" 
	                    		label="Horas"/>
	                    	</f:facet>
	                </p:cellEditor>
	            </p:column>	
	            
	            <p:column headerText="Operações" style="width:8rem">
	                <p:rowEditor/>
	            </p:column>
	            
	            <p:column headerText="Total" style="width: 20px; text-align: center">
	                <h:outputLabel value="totais" />
	            </p:column>
	            
	            <f:facet name="footer">
	                <div class="grid mt-3">
			            <div class="col-12">
			                <h:outputLabel value="totais"/>
                		</div>
			        </div>
	            </f:facet>  
	        </p:dataTable>	    		
	    		
	    </h:form>
    
    </ui:define>
</ui:composition>